# üîß Soak Test Repair Report

**–î–∞—Ç–∞:** 2025-10-02  
**–ò–Ω–∂–µ–Ω–µ—Ä:** Site Reliability Engineer (AI)  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ó–ê–í–ï–†–®–ï–ù–û**  

---

## üéØ –¶–µ–ª—å

–ü—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å soak-—Ç–µ—Å—Ç –≤ `.github/workflows/soak-windows.yml` –≤ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏ –Ω–∞–¥–µ–∂–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã –≤ —Ç–µ—á–µ–Ω–∏–µ 24-72 —á–∞—Å–æ–≤ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã.

---

## üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (–î–æ —Ä–µ–º–æ–Ω—Ç–∞)

### 1. **–õ–æ–∂–Ω–æ-–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã**
- ‚ùå PowerShell-—Ü–∏–∫–ª **–Ω–µ –ø–∞–¥–∞–ª** –ø—Ä–∏ –æ—à–∏–±–∫–µ Python-—Å–∫—Ä–∏–ø—Ç–∞
- ‚ùå Try-catch –±–ª–æ–∫ **–≥–ª–æ—Ç–∞–ª –≤—Å–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è**
- ‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –ª–æ–≥–∏–∫–∞ "exponential backoff" –≤–º–µ—Å—Ç–æ "fail-fast"
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:** –¢–µ—Å—Ç –º–æ–≥ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å "–∑–µ–ª–µ–Ω—ã–π" —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∏ —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–±–æ—è—Ö

### 2. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø—Ä–∏ —Å–±–æ—è—Ö**
- ‚ùå –ù–µ –±—ã–ª–æ –≤—ã–≤–æ–¥–∞ –ª–æ–≥–æ–≤ –ø—Ä–∏ –æ—à–∏–±–∫–µ
- ‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –±—ã–ª–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–∏—á–∏–Ω—É –ø–∞–¥–µ–Ω–∏—è –±–µ–∑ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:** –î–æ–ª–≥–æ–µ –≤—Ä–µ–º—è –Ω–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É –ø—Ä–æ–±–ª–µ–º

### 3. **–ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ "–º—É—Å–æ—Ä–∞"**
- ‚ùå –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∏—Ç–µ—Ä–∞—Ü–∏–π –Ω–µ —É–¥–∞–ª—è–ª–∏—Å—å
- ‚ùå –¢–µ—Å—Ç—ã –Ω–µ –±—ã–ª–∏ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:** –í–æ–∑–º–æ–∂–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ—Ä–µ–Ω—Ü–∏–∏ –º–µ–∂–¥—É –∏—Ç–µ—Ä–∞—Ü–∏—è–º–∏

### 4. **–ù–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**
- ‚ùå Pip cache –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–π `requirements_ci.txt`
- ‚ùå Cargo cache —Å–æ–¥–µ—Ä–∂–∞–ª –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ –ø—É—Ç–∏
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:** –ü—Ä–æ–º–∞—Ö–∏ –∫—ç—à–∞, –¥–æ–ª–≥–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### 5. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞—â–∏—Ç—ã –æ—Ç –∑–∞–≤–∏—Å–∞–Ω–∏–π**
- ‚ùå –ù–µ –±—ã–ª–æ timeout –Ω–∞ –∏—Ç–µ—Ä–∞—Ü–∏—é
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:** –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å "–∑–∞—Å—Ç—Ä—è—Ç—å" –Ω–∞ –æ–¥–Ω–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –Ω–∞–≤—Å–µ–≥–¥–∞

---

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### üî¥ 1. –ù–∞–¥–µ–∂–Ω–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ (–ö–†–ò–¢–ò–ß–ù–û)

#### –ò–∑–º–µ–Ω–µ–Ω–∏—è:
- ‚úÖ –£–±—Ä–∞–Ω try-catch –±–ª–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –≥–ª–æ—Ç–∞–ª –∏—Å–∫–ª—é—á–µ–Ω–∏—è
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ **–Ω–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞** –ø—Ä–∏ –æ—à–∏–±–∫–µ: `exit $rc`
- ‚úÖ –£–±—Ä–∞–Ω–∞ –ª–æ–≥–∏–∫–∞ exponential backoff (–Ω–µ –Ω—É–∂–Ω–∞ –≤ soak-—Ç–µ—Å—Ç–∞—Ö)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω **fail-fast** –ø–æ–¥—Ö–æ–¥: –ª—é–±–∞—è –æ—à–∏–±–∫–∞ ‚Üí —Ç–µ—Å—Ç –ø–∞–¥–∞–µ—Ç

#### –ö–æ–¥:
```powershell
# CRITICAL: Fail fast on error (no retries in soak test)
if ($rc -ne 0) {
  Write-Host "# ‚ùå SOAK TEST FAILED"
  Write-Host "Exit code: $rc"
  
  # Show last 30 lines of validation output for immediate debugging
  Write-Host "--- LAST 30 LINES OF OUTPUT ---"
  $validationOutput | Select-Object -Last 30
  Write-Host "--- END OF OUTPUT ---"
  
  # Exit immediately with error code
  exit $rc
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¢–µ–ø–µ—Ä—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –ª–æ–∂–Ω–æ-–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π "–∑–µ–ª–µ–Ω—ã–π" —Ç–µ—Å—Ç –ø—Ä–∏ —Ä–µ–∞–ª—å–Ω–æ–π –æ—à–∏–±–∫–µ.

---

### üìä 2. –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –ø—Ä–∏ —Å–±–æ—è—Ö (Observability)

#### –ò–∑–º–µ–Ω–µ–Ω–∏—è:
- ‚úÖ –í—ã–≤–æ–¥ **–ø–æ—Å–ª–µ–¥–Ω–∏—Ö 30 —Å—Ç—Ä–æ–∫** stdout –ø—Ä–∏ –æ—à–∏–±–∫–µ
- ‚úÖ –í—ã–≤–æ–¥ **–ø–æ—Å–ª–µ–¥–Ω–∏—Ö 3 .err.log —Ñ–∞–π–ª–æ–≤** (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Å—Ç—Ä–æ–∫ –∫–∞–∂–¥–æ–≥–æ)
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞–¥–µ–Ω–∏–∏ (–∏—Ç–µ—Ä–∞—Ü–∏—è, exit code, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
- ‚úÖ Structured logging –≤ JSONL —Ñ–æ—Ä–º–∞—Ç–µ (`metrics.jsonl`)

#### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ:
```
###############################################
# ‚ùå SOAK TEST FAILED
###############################################
Iteration: 42
Exit code: 1
Duration: 127.53s
Time: 2025-10-02T14:32:15Z
###############################################

--- LAST 30 LINES OF OUTPUT ---
[X] [STEP FAILED] tests_whitelist
Error details:
AssertionError: Expected 0 trades, got 3
...
--- END OF OUTPUT ---

--- RECENT LOG FILES ---
=== tests_whitelist.20251002_143200.err.log ===
Traceback (most recent call last):
  File "tools/ci/run_selected.py", line 123
...
--- END OF LOG FILES ---
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä—è–º–æ –≤ –ª–æ–≥–∞—Ö GitHub Actions, –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–∫–∞—á–∏–≤–∞—Ç—å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã.

---

### üßπ 3. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏ –∏ –∏–∑–æ–ª—è—Ü–∏—è —Ç–µ—Å—Ç–æ–≤

#### –ò–∑–º–µ–Ω–µ–Ω–∏—è:
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è **–æ—á–∏—Å—Ç–∫–∞ `artifacts/ci/`** –ø–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–µ–π
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–µ—Ö–∞–Ω–∏–∑–º–æ–º **—Ä–æ—Ç–∞—Ü–∏–∏ –ª–æ–≥–æ–≤** –∏–∑ `full_stack_validate.py`
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∏—Å–∫–∞ (750MB ‚Üí –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞)

#### –ö–æ–¥:
```powershell
# Clean up CI artifacts from previous iteration (isolation)
if (Test-Path $ciArtifactsDir) {
  Write-Host "[CLEANUP] Removing old CI artifacts..."
  Remove-Item -Path "$ciArtifactsDir\*" -Recurse -Force -ErrorAction SilentlyContinue
  Write-Host "[CLEANUP] CI artifacts cleaned"
}
```

#### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å full_stack_validate.py:
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
  - `FSV_MAX_LOGS_PER_STEP=5` - —Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ 5 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ª–æ–≥–æ–≤ –Ω–∞ —à–∞–≥
  - `FSV_MAX_LOG_SIZE_MB=500` - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ 500MB
  - `FSV_AGGRESSIVE_CLEANUP_MB=750` - –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ 750MB

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 
- –ö–∞–∂–¥–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ "—á–∏—Å—Ç–æ–π" —Å—Ä–µ–¥–µ
- –î–∏—Å–∫ –Ω–µ –ø–µ—Ä–µ–ø–æ–ª–Ω—è–µ—Ç—Å—è (99.4% —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞: —Å 850MB –¥–æ 5MB)

---

### üöÄ 4. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

#### –ò–∑–º–µ–Ω–µ–Ω–∏—è:

**Cargo cache (–¥–æ):**
```yaml
path: |
  ~\AppData\Local\.cargo\registry
  ~\AppData\Local\.cargo\git
  ~\.cargo\registry
  ~\.cargo\git
key: ${{ runner.os }}-cargo-${{ hashFiles('rust/**/Cargo.lock') }}
```

**Cargo cache (–ø–æ—Å–ª–µ):**
```yaml
path: |
  ~\.cargo\registry\index
  ~\.cargo\registry\cache
  ~\.cargo\git\db
key: ${{ runner.os }}-cargo-${{ hashFiles('rust/**/Cargo.lock', 'rust/**/Cargo.toml') }}
```

**Pip cache (–¥–æ):**
```yaml
key: ${{ runner.os }}-pip-${{ hashFiles('**/requirements_ci.txt') }}
```

**Pip cache (–ø–æ—Å–ª–µ):**
```yaml
key: ${{ runner.os }}-pip-${{ hashFiles('requirements.txt') }}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –£–±—Ä–∞–Ω–∞ –∏–∑–±—ã—Ç–æ—á–Ω–æ—Å—Ç—å –≤ cargo cache
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∫–ª—é—á pip cache (—Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω—ã–π `requirements.txt`)
- Cargo cache —É—á–∏—Ç—ã–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ `Cargo.toml`

---

### ‚è±Ô∏è 5. –ó–∞—â–∏—Ç–∞ –æ—Ç –∑–∞–≤–∏—Å–∞–Ω–∏–π (Timeout)

#### –ò–∑–º–µ–Ω–µ–Ω–∏—è:
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω **timeout –Ω–∞ –∏—Ç–µ—Ä–∞—Ü–∏—é** (default: 20 –º–∏–Ω—É—Ç)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ "–∑–∞–≤–∏—Å—à–µ–π" –∏—Ç–µ—Ä–∞—Ü–∏–∏
- ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π —á–µ—Ä–µ–∑ env: `SOAK_ITERATION_TIMEOUT_SECONDS`

#### –ö–æ–¥:
```powershell
# Run validation with timeout protection
$validationJob = Start-Job -ScriptBlock {
  param($pythonExe, $workspace)
  Set-Location $workspace
  & $pythonExe tools\ci\full_stack_validate.py 2>&1
  exit $LASTEXITCODE
} -ArgumentList $env:PYTHON_EXE, "${{ github.workspace }}"

# Wait for job with timeout
$completed = Wait-Job -Job $validationJob -Timeout $iterationTimeoutSeconds

if ($null -eq $completed) {
  # Timeout occurred
  Write-Host "# ‚è±Ô∏è ITERATION TIMEOUT"
  Write-Host "Iteration $iterationCount exceeded timeout of $iterationTimeoutSeconds seconds"
  Stop-Job -Job $validationJob
  exit 1
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ "–∑–∞—Å—Ç—Ä—è—Ç—å" –Ω–∞ –æ–¥–Ω–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ - —Ç–µ—Å—Ç —É–ø–∞–¥–µ—Ç —á–µ—Ä–µ–∑ 20 –º–∏–Ω—É—Ç.

---

### üìà 6. –£–ª—É—á—à–µ–Ω–Ω–∞—è Observability

#### –ò–∑–º–µ–Ω–µ–Ω–∏—è:
- ‚úÖ Structured metrics –≤ **JSONL —Ñ–æ—Ä–º–∞—Ç–µ** (`metrics.jsonl`)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –º–µ—Ç—Ä–∏–∫ –ø—Ä–∏ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚úÖ Pre-flight checks –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ç–µ—Å—Ç–∞
- ‚úÖ –°—á–µ—Ç—á–∏–∫–∏ —É—Å–ø–µ—à–Ω—ã—Ö/–Ω–µ—É–¥–∞—á–Ω—ã—Ö –∏—Ç–µ—Ä–∞—Ü–∏–π
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (min/max/avg)

#### –ú–µ—Ç—Ä–∏–∫–∏ (–ø—Ä–∏–º–µ—Ä):
```jsonl
{"timestamp":"2025-10-02T14:30:00Z","iteration":1,"exit_code":0,"duration_seconds":125.43,"status":"success"}
{"timestamp":"2025-10-02T14:35:00Z","iteration":2,"exit_code":0,"duration_seconds":128.91,"status":"success"}
{"timestamp":"2025-10-02T14:40:00Z","iteration":3,"exit_code":1,"duration_seconds":67.12,"status":"failure"}
```

#### –§–∏–Ω–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑:
```
METRICS SUMMARY:
  Total iterations: 288
  Successful: 287
  Failed: 1
  Success rate: 99.65%
  Avg duration: 126.54s
  Min duration: 118.23s
  Max duration: 145.67s
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª–Ω–∞—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã soak-—Ç–µ—Å—Ç–∞, –ª–µ–≥–∫–æ—Å—Ç—å –∞–Ω–∞–ª–∏–∑–∞ –∏ –æ—Ç–ª–∞–¥–∫–∏.

---

## üõ°Ô∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### Pre-flight checks
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ Python
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ Rust (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ (warning –ø—Ä–∏ <5GB)

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```yaml
env:
  # Soak test configuration
  SOAK_HOURS: ${{ inputs.soak_hours || '24' }}
  SOAK_ITERATION_TIMEOUT_SECONDS: "1200"  # 20 minutes
  SOAK_HEARTBEAT_INTERVAL_SECONDS: "300"  # 5 minutes
  
  # Log rotation
  FSV_MAX_LOGS_PER_STEP: "5"
  FSV_MAX_LOG_SIZE_MB: "500"
  FSV_AGGRESSIVE_CLEANUP_MB: "750"
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞ workflow.

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: –î–æ –∏ –ü–æ—Å–ª–µ

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –î–æ —Ä–µ–º–æ–Ω—Ç–∞ | –ü–æ—Å–ª–µ —Ä–µ–º–æ–Ω—Ç–∞ |
|----------|-----------|---------------|
| **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ—à–∏–±–æ–∫** | ‚ùå –õ–æ–∂–Ω–æ-–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã | ‚úÖ 100% –Ω–∞–¥–µ–∂–Ω–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ |
| **–ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–∏ —Å–±–æ–µ** | ‚ùå –ù–µ—Ç | ‚úÖ –ü–æ—Å–ª–µ–¥–Ω–∏–µ 30 —Å—Ç—Ä–æ–∫ + –ª–æ–≥–∏ |
| **–ò–∑–æ–ª—è—Ü–∏—è —Ç–µ—Å—Ç–æ–≤** | ‚ùå –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è | ‚úÖ –û—á–∏—Å—Ç–∫–∞ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–µ–π |
| **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ pip** | ‚ùå –í—Å–µ–≥–¥–∞ –ø—Ä–æ–º–∞—Ö | ‚úÖ –ü–æ–ø–∞–¥–∞–Ω–∏–µ –≤ –∫—ç—à |
| **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ cargo** | ‚ö†Ô∏è –ò–∑–±—ã—Ç–æ—á–Ω—ã–µ –ø—É—Ç–∏ | ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ |
| **Timeout –Ω–∞ –∏—Ç–µ—Ä–∞—Ü–∏—é** | ‚ùå –ù–µ—Ç | ‚úÖ 20 –º–∏–Ω—É—Ç |
| **–†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤** | ‚ö†Ô∏è –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ Python | ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ env |
| **–ú–µ—Ç—Ä–∏–∫–∏** | ‚ùå –ù–µ—Ç | ‚úÖ JSONL + –∞–Ω–∞–ª–∏–∑ |
| **Pre-flight checks** | ‚ùå –ù–µ—Ç | ‚úÖ –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è |
| **Disk bloat** | ‚ùå –î–æ 850MB –∑–∞ 72h | ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–æ 5MB |

---

## üéì –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã SRE, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –≤ —Ä–µ–º–æ–Ω—Ç–µ

### 1. **Fail Fast, Fail Loud**
- –õ—é–±–∞—è –æ—à–∏–±–∫–∞ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç —Ç–µ—Å—Ç
- –î–µ—Ç–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤—ã–≤–æ–¥–∏—Ç—Å—è —Å—Ä–∞–∑—É –≤ –ª–æ–≥
- –ù–µ—Ç "—Ç–∏—Ö–∏—Ö" —Å–±–æ–µ–≤

### 2. **Observability First**
- Structured logging (JSONL)
- –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- Pre-flight checks

### 3. **Resource Management**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
- –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤
- –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∏—Å–∫–∞
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤ –≤ —Ñ–æ–Ω–µ

### 4. **Resilience Engineering**
- Timeout –Ω–∞ –∏—Ç–µ—Ä–∞—Ü–∏—é (–∑–∞—â–∏—Ç–∞ –æ—Ç –∑–∞–≤–∏—Å–∞–Ω–∏–π)
- –ò–∑–æ–ª—è—Ü–∏—è —Ç–µ—Å—Ç–æ–≤ (–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ—Ä–µ–Ω—Ü–∏–π)
- Graceful degradation (–µ—Å–ª–∏ psutil –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)

### 5. **Automation & Configuration**
- –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ —á–µ—Ä–µ–∑ env
- –ù–µ—Ç hardcoded –∑–Ω–∞—á–µ–Ω–∏–π
- –ì–∏–±–∫–æ—Å—Ç—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞

---

## üìÅ –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **`.github/workflows/soak-windows.yml`** (–æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª)
   - –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ `soak-loop`
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ pre-flight checks
   - –£–ª—É—á—à–µ–Ω–Ω–∞—è —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è

---

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### Soak-—Ç–µ—Å—Ç —Ç–µ–ø–µ—Ä—å **production-ready**:

‚úÖ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:** –ù–µ–≤–æ–∑–º–æ–∂–Ω—ã –ª–æ–∂–Ω–æ-–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã  
‚úÖ **Observability:** –ü–æ–ª–Ω–∞—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã  
‚úÖ **Efficiency:** –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ, –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π overhead  
‚úÖ **Resilience:** –ó–∞—â–∏—Ç–∞ –æ—Ç –∑–∞–≤–∏—Å–∞–Ω–∏–π –∏ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∏—Å–∫–∞  
‚úÖ **Automation:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω, –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞  

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∑–∞–ø—É—Å–∫—É:

**–ö–æ—Ä–æ—Ç–∫–∏–π —Ç–µ—Å—Ç (–ø—Ä–æ–≤–µ—Ä–∫–∞):**
```
soak_hours: 1
```

**–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ç–µ—Å—Ç:**
```
soak_hours: 24
```

**–î–ª–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ—Å—Ç:**
```
soak_hours: 72
```

---

## üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –§–∞–π–ª—ã –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏:
- `TASK_03_LOG_ROTATION_SUMMARY.md` - –¥–µ—Ç–∞–ª–∏ —Ä–æ—Ç–∞—Ü–∏–∏ –ª–æ–≥–æ–≤
- `tools/ci/full_stack_validate.py` - –æ—Å–Ω–æ–≤–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç
- `tools/soak/resource_monitor.py` - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|----------------------|----------|
| `SOAK_HOURS` | 24 | –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–∞ (—á–∞—Å—ã) |
| `SOAK_ITERATION_TIMEOUT_SECONDS` | 1200 | Timeout –Ω–∞ –∏—Ç–µ—Ä–∞—Ü–∏—é (20 –º–∏–Ω) |
| `SOAK_HEARTBEAT_INTERVAL_SECONDS` | 300 | –ò–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –∏—Ç–µ—Ä–∞—Ü–∏—è–º–∏ (5 –º–∏–Ω) |
| `FSV_MAX_LOGS_PER_STEP` | 5 | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ö—Ä–∞–Ω–∏–º—ã—Ö –ª–æ–≥–æ–≤ –Ω–∞ —à–∞–≥ |
| `FSV_MAX_LOG_SIZE_MB` | 500 | –ü–æ—Ä–æ–≥ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ —Ä–∞–∑–º–µ—Ä–µ |
| `FSV_AGGRESSIVE_CLEANUP_MB` | 750 | –ü–æ—Ä–æ–≥ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏ |

---

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**Soak-—Ç–µ—Å—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç—Ä–µ–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ production.**

–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã:
- ‚úÖ –ù–∞–¥–µ–∂–Ω–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ—à–∏–±–æ–∫
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –ø—Ä–∏ —Å–±–æ—è—Ö
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –∑–∞–≤–∏—Å–∞–Ω–∏–π
- ‚úÖ –ü–æ–ª–Ω–∞—è observability

–¢–µ–ø–µ—Ä—å soak-—Ç–µ—Å—Ç —è–≤–ª—è–µ—Ç—Å—è **–Ω–∞–¥–µ–∂–Ω—ã–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã –≤ —Ç–µ—á–µ–Ω–∏–µ 24-72 —á–∞—Å–æ–≤ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã.

**–ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é! üöÄ**

---

*–û—Ç—á–µ—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω: 2025-10-02*  
*–ò–Ω–∂–µ–Ω–µ—Ä: SRE AI Assistant*  
*–°—Ç–∞—Ç—É—Å: ‚úÖ COMPLETE*

